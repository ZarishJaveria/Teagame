<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta charset="UTF-8">
<title>â˜• Chai-N-Catch</title>
<style>
/* --- Global & Desktop Base Styles --- */
/* FALLBACK: Define the custom variable for 1% of the viewport height */
:root {
    --vh: 1vh; 
}

body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: #f6e2b3 url('assets/background.jpg') center/cover no-repeat;
    display: flex;
    justify-content: center;
    align-items: center; 
    /* FIX: Use calc to set height based on the JS-calculated --vh variable */
    height: calc(var(--vh, 1vh) * 100); 
    /* Fallback for modern browsers */
    height: 100dvh; 
    overflow: hidden;
    padding-top: 15px; 
    padding-bottom: 15px; 
    box-sizing: border-box; 
}
#splashScreen { position: fixed; inset: 0; background: linear-gradient(180deg, #f6a500, #8b4513); color: #fff; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 20; opacity: 1; transition: opacity 1s ease-out; }
#splashTitle { font-size: 42px; font-weight: 700; text-shadow: 2px 2px #5b3a29; }
#splashTagline { font-size: 20px; margin-top: 10px; color: #ffe8b3; }
#splashCup { position: relative; margin-top: 30px; width: 100px; height: 100px; background: url('assets/chai-cup.png') center/contain no-repeat; }
.steam { position: absolute; bottom: 100px; left: 50%; width: 20px; height: 40px; background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%); opacity: 0; border-radius: 50%; animation: rise 3s ease-in infinite; }
.steam:nth-child(1){left:45%; animation-delay:0s;} .steam:nth-child(2){left:50%; animation-delay:1s;} .steam:nth-child(3){left:55%; animation-delay:2s;}
@keyframes rise { 0%{transform:translateY(0)scale(0.8);opacity:0;} 30%{opacity:1;} 100%{transform:translateY(-100px)scale(1.4);opacity:0;} }

/* --- Game Container --- */
#gameContainer { 
    text-align: center; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    width: 100%;
    max-width: 450px;
    height: 100%; 
    padding: 0 5px; 
    box-sizing: border-box;
    position: relative; 
}
h1 { margin-bottom: 8px; color: #5b3a29; text-shadow: 1px 1px #fff; font-weight: 700; }
#score { font-size: 22px; color: #4b2e1b; margin-bottom: 10px; }
#heatContainer { width: 90%; height: 16px; background: rgba(150, 80, 40, 0.2); border-radius: 10px; border: 2px solid #8b4513; overflow: hidden; margin-bottom: 10px; }
#heatBar { height: 100%; width: 0%; background: linear-gradient(90deg, #ffcc66, #ff9933, #ff6600); transition: width 0.3s linear; }

/* --- Game Area --- */
#gameArea { 
    width: 90vw; max-width: 450px; 
    height: calc(100% - 130px); 
    max-height: 600px; min-height: 300px; 
    border: 3px solid #8b4513; border-radius: 15px; background: rgba(255,244,229,0.85); 
    position: relative; overflow: hidden; box-shadow: 0 0 20px rgba(139,69,19,0.4); 
    display: flex; flex-direction: column;
}
#cup { position: absolute; bottom: 5%; left: 50%; transform: translateX(-50%); width: 64px; height: 64px; background: url('assets/chai-cup.png') center/contain no-repeat; z-index:5; }
.drop { position: absolute; width: 40px; height: 40px; background-size: contain; background-repeat: no-repeat; z-index:4; }

/* --- Score Feedback Animation CSS --- */
@keyframes score-feedback {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-50px) scale(0.5); opacity: 0; }
}
.score-feedback {
    position: absolute;
    font-weight: 800;
    font-size: 24px;
    pointer-events: none; 
    text-shadow: 1px 1px #fff;
    animation: score-feedback 0.8s ease-out forwards;
    z-index: 10;
}
.positive-score { color: #008000; } 
.negative-score { color: #cc0000; } 
/* --- End Score Feedback Animation CSS --- */

/* --- Start Menu (Remains contained in Game Area) --- */
#startMenu { 
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
    width: 95%; max-width: 400px; background: rgba(248,228,194,0.95); border-radius: 15px; 
    padding: 20px; text-align: center; box-shadow: 0 0 15px rgba(0,0,0,0.3); z-index: 10;
    display: flex; flex-direction: column; box-sizing: border-box; max-height: 90%;
}
#startMenu input { 
    width: 70%; padding: 6px; margin: 8px auto; font-size: 14px; 
    border-radius: 6px; border: 1px solid #8b4513; text-align: center; 
    box-sizing: border-box; display: block; 
}

/* General Button Styling */
#startMenu button, #gameOver .button-row button { 
    margin-top: 10px; padding: 8px 16px; font-size: 16px; 
    background-color: #f6a500; border: none; border-radius: 8px; 
    cursor: pointer; font-weight: 600; width: 70%; 
    margin-left: auto; margin-right: auto; display: block; 
}
#startMenu button:hover { background-color: #ffb84d; }

/* ------------------------------------------------ */
/* Leaderboard/Game Over as Full Screen Overlay */
/* ------------------------------------------------ */
#gameOver { 
    position: fixed; top: 0; left: 0; right: 0; bottom: 0; 
    transform: none; width: 100vw; max-width: none;
    background: rgba(248,228,194,0.98); z-index: 30; padding: 20px; 
    text-align: center; box-sizing: border-box; display: flex; 
    flex-direction: column; max-height: 100vh; justify-content: space-between;
}
#gameOver h2 { margin-top: 0; }
#gameOver p { margin: 5px 0; }
#gameOver .leaderboard-container { 
    flex: 1 1 auto; width: 100%; max-width: 400px; margin: 15px auto; 
    overflow-y: auto; overflow-x: hidden; padding: 0 10px; 
    box-sizing: border-box; max-height: 60vh; 
}

/* Leaderboard Content Styles */
#leaderboard { 
    width: 100%; text-align: left; background: transparent; border: none; 
    padding: 0 5px; box-sizing: border-box; 
}
#leaderboard strong { 
    display: block; font-size: 20px; color: #8b4513; margin-bottom: 12px; 
    text-align: center; text-shadow: 1px 1px #f8e4c2;
}
#leaderboard div.entry { 
    padding: 10px 10px; margin-bottom: 0; border-radius: 0; 
    background: transparent; border-bottom: 1px solid rgba(139, 69, 19, 0.3); 
    display: flex; justify-content: space-between; align-items: center; 
    word-break: break-word; font-weight: 500;
}
#leaderboard div.entry:last-child { border-bottom: none; }

/* Highlight Top 3 Entries */
.leaderboard-entry-rank-1 {
    font-weight: 800 !important; color: #ff9900; background: rgba(255, 215, 0, 0.1) !important; font-size: 1.1em;
}
.leaderboard-entry-rank-2 {
    font-weight: 700 !important; color: #a8a8a8; background: rgba(192, 192, 192, 0.1) !important;
}
.leaderboard-entry-rank-3 {
    font-weight: 600 !important; color: #9e6d4c; background: rgba(150, 80, 40, 0.1) !important;
}

/* Game Over Button Styles */
#gameOver .button-row { flex-shrink: 0; display: flex; justify-content: center; margin-top: 20px; margin-bottom: 20px; width: 100%; }
#gameOver .button-row button { 
    width: 150px; max-width: 45%; margin: 0 10px; padding: 10px 15px; font-weight: 700;
    border: 2px solid #5b3a29; border-radius: 10px; transition: transform 0.1s, box-shadow 0.1s;
    text-shadow: 1px 1px 1px rgba(0,0,0,0.3); box-shadow: 0 4px 0 #5b3a29; transform: translateY(0);
}
#gameOver .button-row button:active { box-shadow: 0 1px 0 #5b3a29; transform: translateY(3px); }
#restartBtn { background-color: #f6a500; color: #fff; }
#exitBtn { background-color: #8b4513; color: #fff; }
#restartBtn:hover { background-color: #ffb84d; }
#exitBtn:hover { background-color: #a8653a; }
/* End Game Over Button Styles */

/* --- Toggle Switch Styling --- */
#soundToggle { position: absolute; top: 0px; right: 5px; display: flex; align-items: center; font-size: 14px; z-index: 15; padding: 5px; cursor: pointer; user-select: none; }
#soundSwitch { opacity: 0; width: 0; height: 0; }
#soundToggle .switch { position: relative; display: inline-block; width: 40px; height: 20px; background-color: #a87f54; border-radius: 20px; transition: background-color 0.3s; flex-shrink: 0; margin-right: 8px; box-shadow: inset 0 0 5px rgba(0,0,0,0.2); }
#soundToggle .switch::before { content: ''; position: absolute; width: 16px; height: 16px; border-radius: 50%; background-color: #fff; top: 2px; left: 2px; transition: transform 0.3s, box-shadow 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
#soundSwitch:checked + .switch { background-color: #f6a500; }
#soundSwitch:checked + .switch::before { transform: translateX(20px); }
#soundToggle .label-text { font-weight: 600; color: #5b3a29; }

/* --- Thank You Overlay with Animation --- */
#thankYouOverlay {
    position: fixed; inset: 0; background: rgba(246, 226, 179, 0.98); 
    color: #5b3a29; font-size: 32px; font-weight: 700; 
    justify-content: center; align-items: center; text-align: center; 
    z-index: 50; visibility: hidden;
    flex-direction: column; 
    gap: 20px; 
}
#thankYouOverlay .cup-icon {
    width: 120px;
    height: 120px;
    background: url('assets/chai-cup.png') center/contain no-repeat;
    animation: spin 3s linear infinite; 
}
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}
/* --- End Thank You Overlay with Animation --- */

footer { position: fixed; bottom: 5px; left: 5px; font-size: 12px; color: #5b3a29; background: rgba(255,255,255,0.7); padding: 5px 10px; border-radius: 8px; z-index: 5; }

/* ---------------------------------------------------- */
/* --- Mobile Specific Media Queries (<= 600px) --- */
/* ---------------------------------------------------- */
@media (max-width: 600px) {
    #gameArea { 
        width: 95vw; 
        height: calc(100% - 130px); 
        min-height: 300px; 
        margin-top: 0; 
    }
    h1 { font-size: 20px; } 
    #score { font-size: 18px; } 
    #gameOver { padding: 10px; }
    #gameOver .leaderboard-container { max-height: 65vh; max-width: 95%; margin: 10px auto; }
    #leaderboard strong { font-size: 18px; }
    #leaderboard div.entry { font-size: 14px; }
    .leaderboard-entry-rank-1 { font-size: 1em; }
    
    #gameOver .button-row button { 
        width: 48%; margin: 0 2%; padding: 8px 10px; font-size: 14px;
        box-shadow: 0 3px 0 #5b3a29;
    }
    #gameOver .button-row { margin-bottom: 10px; }

    #soundToggle { top: 25px; right: 5px; padding: 4px; font-size: 12px; }
    #soundToggle .switch { width: 35px; height: 18px; }
    #soundToggle .switch::before { width: 14px; height: 14px; }
    #soundSwitch:checked + .switch::before { transform: translateX(17px); }
    
    #thankYouOverlay { font-size: 24px; }
    #thankYouOverlay .cup-icon { width: 80px; height: 80px; }
}

/* ---------------------------------------------------- */
/* --- Extra Small Mobile Devices (<= 450px) --- */
/* ---------------------------------------------------- */
@media (max-width: 450px) {
    h1 { font-size: 18px; }
    #score { font-size: 16px; margin-bottom: 5px; }
    #startMenu { padding: 15px; max-width: 95%; }
    #startMenu h2 { font-size: 18px; }
    #startMenu input, #startMenu button { width: 80%; font-size: 13px; padding: 5px; }
    #gameOver h2 { font-size: 20px; }
    #finalScore, #chaiRating { font-size: 14px; }
    #gameOver button { font-size: 14px; padding: 6px 10px; }
    .score-feedback { font-size: 18px; }
}
</style>
</head>
<body>

<div id="splashScreen">
    <div id="splashTitle">Chai-N-Catch</div>
    <div id="splashTagline">Get ready to brew the perfect chai!</div>
    <div id="splashCup">
        <div class="steam"></div><div class="steam"></div><div class="steam"></div>
    </div>
</div>

<div id="gameContainer">
    <h1>Chai-N-Catch</h1>
    
    <div id="soundToggle" class="switch-wrapper">
        <input type="checkbox" id="soundSwitch" checked />
        <label for="soundSwitch" class="switch"></label>
        <span class="label-text">ðŸ”Š Sound</span>
    </div>

    <div id="score">Score: 0 | Lives: 3</div>
    <div id="heatContainer"><div id="heatBar"></div></div>

    <div id="gameArea">
        <div id="cup"></div>

        <div id="startMenu">
            <h2>Enter Your Name</h2>
            <input id="playerNameInput" type="text" autocomplete="off" placeholder="Your name..." />
            
            <button id="playBtn">Play</button>
        </div>

        <div id="gameOver" style="display:none; flex-direction: column;">
            <div>
                <h2>Game Over!</h2>
                <p id="finalScore"></p>
                <p id="chaiRating"></p>
            </div>
            
            <div class="leaderboard-container">
                <div id="leaderboard"></div>
            </div>
            <div class="button-row">
                <button id="restartBtn">Play Again</button>
                <button id="exitBtn">Exit</button>
            </div>
        </div>
    </div>
</div>

<div id="thankYouOverlay" style="display: flex; visibility: hidden;">
    <div class="cup-icon"></div>
    Thanks for Playing! 
</div>

<footer id="gameFooter">â˜• Sounds & Stickers courtesy of <strong>SoundsForYou</strong> (Pixabay) & <strong>Attritube</strong>.</footer>

<script>
// --- Mobile Viewport Fix (The most robust solution) ---
function setVh() {
    // Get the viewport height and calculate 1% of it in pixels
    let vh = window.innerHeight * 0.01;
    // Set the value in the CSS custom property --vh on the root element
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}
// Run once on load
setVh();
// Run on device resize (e.g., orientation change or browser bar hide/show)
window.addEventListener('resize', setVh);

// --- Game Setup ---
const splashScreen = document.getElementById('splashScreen');
const gameFooter = document.getElementById('gameFooter');

setTimeout(()=>{ 
    splashScreen.style.opacity='0'; 
    setTimeout(()=>{
        splashScreen.style.display='none';
        // FIX: Hide footer after splash screen disappears
        gameFooter.style.display = 'none'; 
    },1000); 
},2500);

const gameArea = document.getElementById('gameArea');
const cup = document.getElementById('cup');
const scoreDisplay = document.getElementById('score');
const startMenu = document.getElementById('startMenu');
const playBtn = document.getElementById('playBtn');
const gameOver = document.getElementById('gameOver');
const finalScore = document.getElementById('finalScore');
const chaiRating = document.getElementById('chaiRating');
const restartBtn = document.getElementById('restartBtn');
const exitBtn = document.getElementById('exitBtn');
const heatBar = document.getElementById('heatBar');
const leaderboardDiv = document.getElementById('leaderboard');
const playerNameInput = document.getElementById('playerNameInput');
const thankYouOverlay = document.getElementById('thankYouOverlay');
const soundToggle = document.getElementById('soundToggle'); 
const soundSwitch = document.getElementById('soundSwitch'); 
const gameContainer = document.getElementById('gameContainer');

let score=0, lives=3, cupX=170, gameRunning=false;
let playerName="";
let soundEnabled = soundSwitch.checked; 
const ingredients = [
    { type:'biscuit', points:2, img:'assets/biscuit.png'},
    { type:'cardamom', points:2, img:'assets/cardamom.png'},
    { type:'ginger', points:2, img:'assets/ginger.png'},
    { type:'fly', points:-1, img:'assets/fly.png'}
];

// --- Sounds ---
function playCatchSound(){ 
    if (!soundEnabled) return; 
    const ctx=new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type="square"; o.frequency.setValueAtTime(800, ctx.currentTime); g.gain.setValueAtTime(0.2, ctx.currentTime); o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+0.1);
}
function playFailSound(){ 
    if (!soundEnabled) return; 
    const ctx=new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type="sawtooth"; o.frequency.setValueAtTime(200, ctx.currentTime); g.gain.setValueAtTime(0.3, ctx.currentTime); o.connect(g); g.connect(ctx.destination); o.start(); o.stop(ctx.currentTime+0.3);
}

// --- Score Feedback Function ---
function showScoreFeedback(points, dropElement) {
    const feedback = document.createElement('div');
    feedback.textContent = (points > 0 ? '+' : '') + points;
    feedback.classList.add('score-feedback', points > 0 ? 'positive-score' : 'negative-score');
    
    const dropRect = dropElement.getBoundingClientRect();
    const gameAreaRect = gameArea.getBoundingClientRect();
    const x = dropRect.left - gameAreaRect.left + dropRect.width / 2 - 15;
    const y = dropRect.top - gameAreaRect.top;
    
    feedback.style.left = `${x}px`;
    feedback.style.top = `${y}px`; 
    
    gameArea.appendChild(feedback);

    setTimeout(() => {
        feedback.remove();
    }, 800);
}

// --- Sound Toggle Logic ---
soundSwitch.addEventListener('change', () => {
    soundEnabled = soundSwitch.checked; 
    const labelText = soundToggle.querySelector('.label-text');
    if (soundEnabled) {
        labelText.textContent = 'ðŸ”Š Sound';
    } else {
        labelText.textContent = 'ðŸ”‡ Sound';
    }
});

// --- Cup Movement ---
let leftPressed=false, rightPressed=false;
document.addEventListener('keydown', e=>{ if(!gameRunning) return; if(e.key==='ArrowLeft') leftPressed=true; if(e.key==='ArrowRight') rightPressed=true; });
document.addEventListener('keyup', e=>{ if(!gameRunning) return; if(e.key==='ArrowLeft') leftPressed=false; if(e.key==='ArrowRight') rightPressed=false; });
setInterval(()=>{ if(!gameRunning) return; if(leftPressed && cupX>0) cupX-=10; if(rightPressed && cupX<gameArea.clientWidth-64) cupX+=10; cup.style.left=cupX+'px'; },30);

// --- Drops ---
function createDrop(){
    if(!gameRunning) return;
    const drop=document.createElement('div'); drop.classList.add('drop');
    const item=ingredients[Math.floor(Math.random()*ingredients.length)];
    drop.dataset.points=item.points; drop.style.backgroundImage=`url('${item.img}')`;
    drop.style.left=Math.random()*(gameArea.clientWidth-40)+'px'; drop.style.top='0px';
    gameArea.appendChild(drop);
    const baseSpeed=4;
    const interval=setInterval(()=>{
        const fallSpeed=baseSpeed+Math.floor(score/20);
        const dropTop=parseFloat(drop.style.top);
        drop.style.top=(dropTop+fallSpeed)+'px';
        const dropRect=drop.getBoundingClientRect();
        const cupRect=cup.getBoundingClientRect();
        if(dropRect.bottom>=cupRect.top-5 && dropRect.bottom<=cupRect.top+15 && dropRect.left<cupRect.right && dropRect.right>cupRect.left){
            const pts=parseInt(drop.dataset.points);
            score+=pts; 
            pts>0?playCatchSound(): (playFailSound(), lives--);
            
            showScoreFeedback(pts, drop);

            updateUI(); drop.remove(); clearInterval(interval);
            if(lives<=0) endGame();
        }
        if(dropTop>gameArea.clientHeight){ drop.remove(); clearInterval(interval); }
    },10);
}
setInterval(()=>{ if(!gameRunning) return; createDrop(); },800);

// --- UI ---
function updateUI(){ scoreDisplay.textContent=`Score: ${score} | Lives: ${lives}`; heatBar.style.width=Math.min(score,100)+'%'; }

// --- Start Game ---
function startGame(){ playerName=playerNameInput.value.trim()||"Player"; startMenu.style.display='none'; gameRunning=true; }
playBtn.addEventListener('click', startGame);
playerNameInput.addEventListener('keydown', e=>{ if(e.key==='Enter') startGame(); });

// --- Touch Support ---
let touchActive=false;
gameArea.addEventListener('touchstart', e=>{ if(!gameRunning) return; touchActive=true; moveCupToTouch(e.touches[0].clientX); });
gameArea.addEventListener('touchmove', e=>{ if(!gameRunning||!touchActive) return; e.preventDefault(); moveCupToTouch(e.touches[0].clientX); });
gameArea.addEventListener('touchend', ()=>{ touchActive=false; });
function moveCupToTouch(touchX){ const rect=gameArea.getBoundingClientRect(); let x=touchX-rect.left-cup.offsetWidth/2; x=Math.max(0,Math.min(x,gameArea.clientWidth-cup.offsetWidth)); cupX=x; cup.style.left=`${cupX}px`; }

// --- JSONBin Integration (Highest Score Only Logic) ---
const API_KEY = "$2a$10$npLs6be2DWKWjV8u3LskXe/ChVxjRtRJaajPj5eVRYiPTUE.ub.Dq";
const BIN_ID = "6901c798d0ea881f40c44bf6"; 

async function fetchScores() {
    try {
        const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: { "X-Master-Key": API_KEY } });
        const data = await res.json();
        return Array.isArray(data.record) ? data.record : [];
    } catch(e) { 
        console.error("Error fetching scores:", e); 
        return []; 
    }
}

async function saveScore(name, score) {
    name = name.trim(); 
    if (!name) return []; 
    
    try {
        const currentScores = await fetchScores();
        let updatedScores;
        const existingPlayerIndex = currentScores.findIndex(s => s.name.toLowerCase() === name.toLowerCase());

        if (existingPlayerIndex !== -1) {
            if (score > currentScores[existingPlayerIndex].score) {
                currentScores[existingPlayerIndex].score = score;
            }
            updatedScores = currentScores;
        } else {
            updatedScores = [...currentScores, { name, score }];
        }

        updatedScores.sort((a, b) => b.score - a.score);

        const saveRes = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json",
                "X-Master-Key": API_KEY
            },
            body: JSON.stringify(updatedScores)
        });

        if (!saveRes.ok) {
            const errorText = await saveRes.text();
            throw new Error(`HTTP error! Status: ${saveRes.status}. Response: ${errorText}`);
        }

        return updatedScores;
    } catch (e) {
        console.error("Error saving score:", e);
        return []; 
    }
}

async function displayLeaderboard() {
    leaderboardDiv.innerHTML=`<strong>Leaderboard</strong><div>Loading scores...</div>`;
    const scores = await fetchScores(); 
    
    if(scores.length===0){ 
        leaderboardDiv.innerHTML="<strong>Leaderboard</strong><div>No scores yet.</div>"; 
    } else {
        leaderboardDiv.innerHTML="<strong>Leaderboard</strong>"+scores.map((s,i)=>{
            let rankClass = '';
            if (i === 0) rankClass = 'leaderboard-entry-rank-1';
            else if (i === 1) rankClass = 'leaderboard-entry-rank-2';
            else if (i === 2) rankClass = 'leaderboard-entry-rank-3';
            return `<div class="entry ${rankClass}"><span>${i+1}. ${s.name}</span><span>${s.score}</span></div>`;
        }).join("");
    }
}

// --- End Game ---
async function endGame(){
    gameRunning=false;
    finalScore.textContent=`Final Score: ${score}`;
    if(score>=50) chaiRating.textContent="Chai Kadak! â˜•ðŸ”¥";
    else if(score>=30) chaiRating.textContent="Chai Perfect! â˜•ðŸ˜Š";
    else if(score>=10) chaiRating.textContent="Chai Thodi Patliâ€¦ â˜•ðŸ˜";
    else chaiRating.textContent="Chai Watered Downâ€¦ â˜•ðŸ’§";
    gameOver.style.display='flex';
    await saveScore(playerName, score); 
    await displayLeaderboard();
}

// --- Restart / Exit ---
restartBtn.addEventListener('click', ()=>{
    score=0; lives=3; gameRunning=true;
    gameOver.style.display='none'; leaderboardDiv.style.display='block';
    scoreDisplay.textContent=`Score: ${score} | Lives: ${lives}`;
    heatBar.style.width='0%';
    cupX=gameArea.clientWidth/2-cup.offsetWidth/2; cup.style.left=`${cupX}px`;
    document.querySelectorAll('.drop').forEach(d=>d.remove());
});

exitBtn.addEventListener('click', ()=>{
    // Hide game elements and show the thank you overlay
    gameOver.style.display='none'; 
    gameContainer.style.display='none'; 
    thankYouOverlay.style.display='flex'; // Show the flex container
    thankYouOverlay.style.visibility='visible';
    // Ensure footer remains hidden
    gameFooter.style.display = 'none'; 
});
</script>
</body>
</html>
